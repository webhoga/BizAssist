import{getNotFound as ke}from"./@qwik-city-not-found-paths.js";import{isStaticPath as Z}from"./@qwik-city-static-paths.js";import{v as De,_ as Pe,a as $e}from"./q-DwMdM6sh.js";import{s as Oe,m as Ne,r as We}from"./q-XS1ry9VH.js";import Le from"./@qwik-city-plan.js";function j(e,t){let n="Server Error";return t!=null&&(typeof t.message=="string"?n=t.message:n=String(t)),"<html>"+Ue(e,n)+"</html>"}function Ue(e,t){typeof e!="number"&&(e=500),typeof t=="string"?t=Ie(t):t="";const n=typeof t=="string"?"600px":"300px",r=e>=500?Fe:ve;return`
<head>
  <meta charset="utf-8">
  <meta http-equiv="Status" content="${e}">
  <title>${e} ${t}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { color: ${r}; background-color: #fafafa; padding: 30px; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif; }
    p { max-width: ${n}; margin: 60px auto 30px auto; background: white; border-radius: 4px; box-shadow: 0px 0px 50px -20px ${r}; overflow: hidden; }
    strong { display: inline-block; padding: 15px; background: ${r}; color: white; }
    span { display: inline-block; padding: 15px; }
  </style>
</head>
<body><p><strong>${e}</strong> <span>${t}</span></p></body>
`}var He=/[&<>]/g,Ie=e=>e.replace(He,t=>{switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return""}}),ve="#006ce9",Fe="#713fc2",Qe={lax:"Lax",Lax:"Lax",None:"None",none:"None",strict:"Strict",Strict:"Strict"},ze={seconds:1,minutes:60,hours:3600,days:3600*24,weeks:3600*24*7},q=(e,t,n)=>{const r=[`${e}=${t}`];typeof n.domain=="string"&&r.push(`Domain=${n.domain}`),typeof n.maxAge=="number"?r.push(`Max-Age=${n.maxAge}`):Array.isArray(n.maxAge)?r.push(`Max-Age=${n.maxAge[0]*ze[n.maxAge[1]]}`):typeof n.expires=="number"||typeof n.expires=="string"?r.push(`Expires=${n.expires}`):n.expires instanceof Date&&r.push(`Expires=${n.expires.toUTCString()}`),n.httpOnly&&r.push("HttpOnly"),typeof n.path=="string"&&r.push(`Path=${n.path}`);const i=Ge(n.sameSite);return i&&r.push(`SameSite=${i}`),n.secure&&r.push("Secure"),r.join("; ")};function E(e){try{return decodeURIComponent(e)}catch{return e}}var je=e=>{const t={};if(typeof e=="string"&&e!==""){const n=e.split(";");for(const r of n){const i=r.indexOf("=");i!==-1&&(t[E(r.slice(0,i).trim())]=E(r.slice(i+1).trim()))}}return t};function Ge(e){if(e===!0)return"Strict";if(e===!1)return"None";if(e)return Qe[e]}var M=Symbol("request-cookies"),O=Symbol("response-cookies"),_=Symbol("live-cookies"),Ke=class{[M];[O]={};[_]={};appendCounter=0;constructor(e){this[M]=je(e),this[_]={...this[M]}}get(e,t=!0){const n=this[t?_:M][e];return n?{value:n,json(){return JSON.parse(n)},number(){return Number(n)}}:null}getAll(e=!0){return Object.keys(this[e?_:M]).reduce((t,n)=>(t[n]=this.get(n),t),{})}has(e,t=!0){return!!this[t?_:M][e]}set(e,t,n={}){this[_][e]=typeof t=="string"?t:JSON.stringify(t);const r=typeof t=="string"?t:encodeURIComponent(JSON.stringify(t));this[O][e]=q(e,r,n)}append(e,t,n={}){this[_][e]=typeof t=="string"?t:JSON.stringify(t);const r=typeof t=="string"?t:encodeURIComponent(JSON.stringify(t));this[O][++this.appendCounter]=q(e,r,n)}delete(e,t){this.set(e,"deleted",{...t,maxAge:0}),this[_][e]=null}headers(){return Object.values(this[O])}},Je=(e,t)=>{const n=t.headers();if(n.length>0){const r=new Headers(e);for(const i of n)r.append("Set-Cookie",i);return r}return e},N=class extends Error{constructor(e,t){super(typeof t=="string"?t:void 0),this.status=e,this.data=t}},H=class{},X=class extends H{},de=class extends H{constructor(e){super(),this.pathname=e}},ee=new WeakMap,te="qaction",Xe="qfunc",ne="qdata";function Be(e,t){const n=ie(e),r=re(e),i=ie(t),a=re(t);return he(e,n,r,t,i,a)}function he(e,t,n,r,i,a){if(r.startsWith("/build/"))return null;let s=null;for(;t<n;){const o=e.charCodeAt(t++),c=r.charCodeAt(i++);if(o===91){const l=pe(e,t),f=t+(l?3:0),h=G(e,f,n,93),d=e.substring(f,h),p=G(e,h+1,n,47),g=e.substring(h+1,p);t=h+1;const S=i-1;if(l){const T=Ve(d,g,r,S,a,e,t+g.length+1,n);if(T)return Object.assign(s||(s={}),T)}const w=G(r,S,a,47,g);if(w==-1)return null;const b=r.substring(S,w);if(!l&&!g&&!b)return null;i=w,(s||(s={}))[d]=decodeURIComponent(b)}else if(o!==c&&!(isNaN(c)&&Ye(e,t)))return null}return ae(e,t)&&ae(r,i)?s||{}:null}function Ye(e,t){return e.charCodeAt(t)===91&&pe(e,t+1)}function re(e){const t=e.length;return t>1&&e.charCodeAt(t-1)===47?t-1:t}function ae(e,t){const n=e.length;return t>=n||t==n-1&&e.charCodeAt(t)===47}function ie(e){return e.charCodeAt(0)===47?1:0}function pe(e,t){return e.charCodeAt(t)===46&&e.charCodeAt(t+1)===46&&e.charCodeAt(t+2)===46}function G(e,t,n,r,i=""){for(;t<n&&e.charCodeAt(t)!==r;)t++;const a=i.length;for(let s=0;s<a;s++)if(e.charCodeAt(t-a+s)!==i.charCodeAt(s))return-1;return t-a}function Ve(e,t,n,r,i,a,s,o){n.charCodeAt(r)===47&&r++;let c=i;const l=t+"/";for(;c>=r;){const f=he(a,s,o,n,c,i);if(f){let d=n.substring(r,Math.min(c,i));return d.endsWith(l)&&(d=d.substring(0,d.length-l.length)),f[e]=decodeURIComponent(d),f}const h=Ze(n,r,l,c,r-1)+l.length;if(c===h)break;c=h}return null}function Ze(e,t,n,r,i){let a=e.lastIndexOf(n,r);return a==r-n.length&&(a=e.lastIndexOf(n,r-n.length-1)),a>t?a:i}var qe=async(e,t,n,r,i)=>{if(!Array.isArray(e))return null;for(const a of e){const s=a[0],o=Be(s,r);if(!o)continue;const c=a[1],l=a[3],f=new Array(c.length),h=[];c.forEach((p,g)=>{se(p,h,S=>f[g]=S,n)});let d;if(!i){const p=Ee(t,r);se(p,h,g=>d=g?.default,n)}return h.length>0&&await Promise.all(h),[s,o,f,d,l]}return null},se=(e,t,n,r)=>{if(typeof e=="function"){const i=ee.get(e);if(i)n(i);else{const a=e();typeof a.then=="function"?t.push(a.then(s=>{r!==!1&&ee.set(e,s),n(s)})):a&&n(a)}}},Ee=(e,t)=>{if(e){t=t.endsWith("/")?t:t+"/";const n=e.find(r=>r[0]===t||t.startsWith(r[0]));if(n)return n[1]}},et=e=>e&&typeof e.then=="function";function tt(e){const t=[];return e==="day"?e=3600*24:e==="week"?e=3600*24*7:e==="month"?e=3600*24*30:e==="year"?e=3600*24*365:e==="private"?e={private:!0,noCache:!0}:e==="immutable"?e={public:!0,immutable:!0,maxAge:3600*24*365}:e==="no-cache"&&(e={noCache:!0}),typeof e=="number"&&(e={maxAge:e,sMaxAge:e}),e.immutable&&t.push("immutable"),e.maxAge&&t.push(`max-age=${e.maxAge}`),e.sMaxAge&&t.push(`s-maxage=${e.sMaxAge}`),e.noStore&&t.push("no-store"),e.noCache&&t.push("no-cache"),e.private&&t.push("private"),e.public&&t.push("public"),e.staleWhileRevalidate&&t.push(`stale-while-revalidate=${e.staleWhileRevalidate}`),e.staleIfError&&t.push(`stale-if-error=${e.staleIfError}`),t.join(", ")}var W;import("node:async_hooks").then(e=>{const t=e.AsyncLocalStorage;W=new t,globalThis.qcAsyncRequestStore=W}).catch(e=>{console.warn("AsyncLocalStorage not available, continuing without it. This might impact concurrent server calls.",e)});function nt(e,t,n,r,i=!0,a="/",s){let o;const c=new Promise(f=>o=f),l=at(e,t,n,i,a,s,o);return{response:c,requestEv:l,completion:W?W.run(l,oe,l,r,o):oe(l,r,o)}}async function oe(e,t,n){try{(s=>new URL(s.pathname+s.search,s))(e.originalUrl)}catch{const s="Resource Not Found";e.status(404);const o=j(404,s);return e.html(404,o),new N(404,s)}let r=1;async function i(){try{await e.next()}catch(a){if(a instanceof X)await e.getWritableStream().close();else if(a instanceof de){if(r>50)throw new Error("Infinite rewrite loop");r+=1;const s=new URL(e.url);s.pathname=a.pathname;const{loadedRoute:o,requestHandlers:c}=await t(s);return e.resetRoute(o,c,s),await i()}else if(a instanceof N){if(!e.headersSent){const s=a.status,o=e.request.headers.get("Accept");if(o&&!o.includes("text/html")){const c=e[D];e.headers.set("Content-Type","application/qwik-json"),e.send(s,await c._serializeData(a.data,!0))}else{const c=j(a.status,a.data);e.html(s,c)}}}else if(!(a instanceof H)){if(F(e)!=="dev")try{e.headersSent||(e.headers.set("content-type","text/html; charset=utf-8"),e.cacheControl({noCache:!0}),e.status(500));const s=e.getWritableStream();if(!s.locked){const o=s.getWriter();await o.write(Q.encode(j(500,"Internal Server Error"))),await o.close()}}catch{console.error("Unable to render error page")}return a}}}try{return await i()}finally{e.isDirty()||n(null)}}function J(e,t){const n=e.endsWith(k);if(n){const r=e.length-k.length+(t?1:0);e=e.slice(0,r),e===""&&(e="/")}return{pathname:e,isInternal:n}}var B="@isQData",k="/q-data.json",me=Symbol("RequestEvLoaders"),ge=Symbol("RequestEvMode"),we=Symbol("RequestEvRoute"),D=Symbol("RequestEvQwikSerializer"),ye=Symbol("RequestEvTrailingSlash"),Se="@routeName",I="@actionId",be="@actionFormData",rt="@nonce",Re="@rewrite";function at(e,t,n,r,i,a,s){const{request:o,platform:c,env:l}=e,f=new Map,h=new Ke(o.headers.get("cookie")),d=new Headers,p=new URL(o.url),{pathname:g,isInternal:S}=J(p.pathname,r);S&&(p.pathname=g,f.set(B,!0));let w=-1,b=null,T,P=e.locale,x=200;const xe=async()=>{for(w++;w<n.length;){const u=n[w],m=globalThis.qcAsyncRequestStore,y=m?.run?m.run(R,u,R):u(R);et(y)&&await y,w++}},_e=(u,m,y=p)=>{t=u,n=m,p.pathname=y.pathname,p.search=y.search,w=-1},C=()=>{if(b!==null)throw new Error("Response already sent")},$=(u,m)=>{if(C(),typeof u=="number"){x=u;const A=R.getWritableStream().getWriter();A.write(typeof m=="string"?Q.encode(m):m),A.close()}else if(x=u.status,u.headers.forEach((y,A)=>{A.toLowerCase()!=="set-cookie"&&d.append(A,y)}),u.headers.getSetCookie().forEach(y=>{const A=y.indexOf("=");if(A===-1)return;const Ce=y.slice(0,A).trim(),Me=y.slice(A+1).trim();h.set(Ce,Me)}),u.body){const y=R.getWritableStream();u.body.pipeTo(y)}else R.getWritableStream().getWriter().close();return V()},V=()=>(w=K,new H),z={},R={[me]:z,[ge]:e.mode,[ye]:r,get[we](){return t},[D]:a,cookie:h,headers:d,env:l,method:o.method,signal:o.signal,originalUrl:new URL(p),get params(){return t?.[1]??{}},get pathname(){return p.pathname},platform:c,get query(){return p.searchParams},request:o,url:p,basePathname:i,sharedMap:f,get headersSent(){return b!==null},get exited(){return w>=K},get clientConn(){return e.getClientConn()},next:xe,resetRoute:_e,exit:V,cacheControl:(u,m="Cache-Control")=>{C(),d.set(m,tt(u))},resolveValue:(async u=>{const m=u.__id;if(u.__brand==="server_loader"&&!(m in z))throw new Error("You can not get the returned data of a loader that has not been executed for this request.");return z[m]}),status:u=>typeof u=="number"?(C(),x=u,u):x,locale:u=>(typeof u=="string"&&(P=u),P||""),error:(u,m)=>(x=u,d.delete("Cache-Control"),new N(u,m)),redirect:(u,m)=>{if(C(),x=u,m){if(/([^:])\/{2,}/.test(m)){const y=m.replace(/([^:])\/{2,}/g,"$1/");console.warn(`Redirect URL ${m} is invalid, fixing to ${y}`),m=y}d.set("Location",m)}return d.delete("Cache-Control"),u>301&&d.set("Cache-Control","no-store"),w=K,new X},rewrite:u=>{if(C(),u.startsWith("http"))throw new Error("Rewrite does not support absolute urls");return f.set(Re,!0),new de(u.replace(/\/+/g,"/"))},defer:u=>typeof u=="function"?u:()=>u,fail:(u,m)=>(C(),x=u,d.delete("Cache-Control"),{failed:!0,...m}),text:(u,m)=>(d.set("Content-Type","text/plain; charset=utf-8"),$(u,m)),html:(u,m)=>(d.set("Content-Type","text/html; charset=utf-8"),$(u,m)),parseBody:async()=>T!==void 0?T:T=st(R,f,a),json:(u,m)=>(d.set("Content-Type","application/json; charset=utf-8"),$(u,JSON.stringify(m))),send:$,isDirty:()=>b!==null,getWritableStream:()=>{if(b===null){if(e.mode==="dev"){const u=f.get("@serverTiming");u&&d.set("Server-Timing",u.map(m=>`${m[0]};dur=${m[1]}`).join(","))}b=e.getWritableStream(x,d,h,s,R)}return b}};return Object.freeze(R)}function v(e){return e[me]}function Y(e){return e[ye]}function it(e){return e[we]}function F(e){return e[ge]}var K=Number.MAX_SAFE_INTEGER,st=async({request:e,method:t,query:n},r,i)=>{var a;const s=((a=e.headers.get("content-type"))==null?void 0:a.split(/[;,]/,1)[0].trim())??"";if(s==="application/x-www-form-urlencoded"||s==="multipart/form-data"){const o=await e.formData();return r.set(be,o),ot(o)}else{if(s==="application/json")return await e.json();if(s==="application/qwik-json"){if(t==="GET"&&n.has(ne)){const o=n.get(ne);if(o)try{return i._deserializeData(decodeURIComponent(o))}catch{}}return i._deserializeData(await e.text())}}},ot=e=>[...e.entries()].reduce((n,[r,i])=>(r.split(".").reduce((a,s,o,c)=>{if(s.endsWith("[]")){const l=s.slice(0,-2);return a[l]=a[l]||[],a[l]=[...a[l],i]}return o<c.length-1?a[s]=a[s]||(Number.isNaN(+c[o+1])?{}:[]):a[s]=i},n),n),{});function ct(e){const{params:t,request:n,status:r,locale:i,originalUrl:a}=e,s={};n.headers.forEach((S,w)=>s[w]=S);const o=e.sharedMap.get(I),c=e.sharedMap.get(be),l=e.sharedMap.get(Se),f=e.sharedMap.get(rt),h=e.request.headers,d=new URL(a.pathname+a.search,a),p=h.get("X-Forwarded-Host"),g=h.get("X-Forwarded-Proto");return p&&(d.port="",d.host=p),g&&(d.protocol=g),{url:d.href,requestHeaders:s,locale:i(),nonce:f,containerAttributes:{"q:route":l},qwikcity:{routeName:l,ev:e,params:{...t},loadedRoute:it(e),response:{status:r(),loaders:v(e),action:o,formData:c}}}}var lt=(e,t,n,r,i,a)=>{const s=[],o=[],c=[],l=!!(t&&mt(t[2]));if(a&&c.push(St),e&&ce(s,o,c,e,l,n),t){const f=t[0];r&&(n==="POST"||n==="PUT"||n==="PATCH"||n==="DELETE")&&(r==="lax-proto"?c.unshift(gt):c.unshift(wt)),l&&((n==="POST"||n==="GET")&&c.push(dt),c.push(ht),a&&c.push(bt));const h=t[2];ce(s,o,c,h,l,n),l&&(c.push(d=>{d.sharedMap.set(Se,f)}),c.push(ft(o,s)),c.push(i))}return c},ce=(e,t,n,r,i,a)=>{for(const s of r){typeof s.onRequest=="function"?n.push(s.onRequest):Array.isArray(s.onRequest)&&n.push(...s.onRequest);let o;switch(a){case"GET":{o=s.onGet;break}case"POST":{o=s.onPost;break}case"PUT":{o=s.onPut;break}case"PATCH":{o=s.onPatch;break}case"DELETE":{o=s.onDelete;break}case"OPTIONS":{o=s.onOptions;break}case"HEAD":{o=s.onHead;break}}if(typeof o=="function"?n.push(o):Array.isArray(o)&&n.push(...o),i)for(const c of Object.values(s))typeof c=="function"&&(c.__brand==="server_loader"?e.push(c):c.__brand==="server_action"&&t.push(c))}};function ft(e,t){return async n=>{if(n.headersSent){n.exit();return}const{method:r}=n,i=v(n),a=F(n)==="dev",s=n[D];if(a&&r==="GET"&&n.query.has(te)&&console.warn(`Seems like you are submitting a Qwik Action via GET request. Qwik Actions should be submitted via POST request.
Make sure your <form> has method="POST" attribute, like this: <form method="POST">`),r==="POST"){const o=n.query.get(te);if(o){const c=globalThis._qwikActionsMap,l=e.find(f=>f.__id===o)??c?.get(o);if(l){n.sharedMap.set(I,o);const f=await n.parseBody();if(!f||typeof f!="object")throw new Error(`Expected request data for the action id ${o} to be an object`);const h=await le(n,l.__validators,f,a);if(!h.success)i[o]=n.fail(h.status??500,h.error);else{const d=a?await U(n,l.__qrl.getSymbol().split("_",1)[0],()=>l.__qrl.call(n,h.data,n)):await l.__qrl.call(n,h.data,n);a&&L(s,d,l.__qrl),i[o]=d}}}}if(t.length>0){const o=t.map(c=>{const l=c.__id;return i[l]=le(n,c.__validators,void 0,a).then(f=>f.success?a?U(n,c.__qrl.getSymbol().split("_",1)[0],()=>c.__qrl.call(n,n)):c.__qrl.call(n,n):n.fail(f.status??500,f.error)).then(f=>(typeof f=="function"?i[l]=f():(a&&L(s,f,c.__qrl),i[l]=f),f)),i[l]});await Promise.all(o)}}}async function le(e,t,n,r){let i={success:!0,data:n};if(t)for(const a of t)if(r?i=await U(e,"validator$",()=>a.validate(e,n)):i=await a.validate(e,n),i.success)n=i.data;else return i;return i}function ut(e){return e?typeof e=="object"&&Symbol.asyncIterator in e:!1}async function dt(e){const t=e.query.get(Xe);if(t&&e.request.headers.get("X-QRL")===t&&e.request.headers.get("Content-Type")==="application/qwik-json"){e.exit();const n=F(e)==="dev",r=e[D],i=await e.parseBody();if(Array.isArray(i)){const[a,...s]=i;if(pt(a)&&a.getHash()===t){let o;try{n?o=await U(e,`server_${a.getSymbol()}`,()=>a.apply(e,s)):o=await a.apply(e,s)}catch(c){throw c instanceof N?e.error(c.status,c.data):e.error(500,"Invalid request")}if(ut(o)){e.headers.set("Content-Type","text/qwik-json-stream");const l=e.getWritableStream().getWriter();for await(const f of o){n&&L(r,f,a);const h=await r._serializeData(f,!0);if(e.signal.aborted)break;await l.write(Q.encode(`${h}
`))}l.close()}else{L(r,o,a),e.headers.set("Content-Type","application/qwik-json");const c=await r._serializeData(o,!0);e.send(200,c)}return}}throw e.error(500,"Invalid request")}}function ht(e){const t=Y(e),{basePathname:n,originalUrl:r,sharedMap:i}=e,{pathname:a,search:s}=r;if(!i.has(B)&&a!==n&&!a.endsWith(".html")){if(t){if(!a.endsWith("/"))throw e.redirect(301,a+"/"+s)}else if(a.endsWith("/"))throw e.redirect(301,a.slice(0,a.length-1)+s)}}function L(e,t,n){try{e._verifySerializable(t,void 0)}catch(r){throw r instanceof Error&&n.dev&&(r.loc=n.dev),r}}var pt=e=>typeof e=="function"&&typeof e.getSymbol=="function";function mt(e){const t=e[e.length-1];return t&&typeof t.default=="function"}function Ae(e,t){e=new URL(e),e.pathname.endsWith(k)&&(e.pathname=e.pathname.slice(0,-k.length)),t?e.pathname.endsWith("/")||(e.pathname+="/"):e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1));const n=e.search.slice(1).replaceAll(/&?q(action|data|func)=[^&]+/g,"");return`${e.pathname}${n?`?${n}`:""}${e.hash}`}var Q=new TextEncoder;function gt(e){Te(e,"lax-proto")}function wt(e){Te(e)}function Te(e,t){if(At(e.request.headers,"application/x-www-form-urlencoded","multipart/form-data","text/plain")){const r=e.request.headers.get("origin"),i=e.url.origin;let a=r!==i;if(a&&t&&r?.replace(/^http(s)?/g,"")===i.replace(/^http(s)?/g,"")&&(a=!1),a)throw e.error(403,`CSRF check failed. Cross-site ${e.method} form submissions are forbidden.
The request origin "${r}" does not match the server origin "${i}".`)}}function yt(e){return async t=>{if(t.headersSent||t.sharedMap.has(B))return;t.request.headers.forEach((h,d)=>h);const r=t.headers;r.has("Content-Type")||r.set("Content-Type","text/html; charset=utf-8");const i=Y(t),{readable:a,writable:s}=new TextEncoderStream,o=t.getWritableStream(),c=a.pipeTo(o,{preventClose:!0}),l=s.getWriter(),f=t.status();try{const h=F(t)==="static",d=ct(t),p=await e({base:t.basePathname+"build/",stream:l,serverData:d,containerAttributes:{"q:render":h?"static":"",...d.containerAttributes}}),g={loaders:v(t),action:t.sharedMap.get(I),status:f!==200?f:200,href:Ae(t.url,i)};typeof p.html=="string"&&await l.write(p.html),t.sharedMap.set("qData",g)}finally{await l.ready,await l.close(),await c}await o.close()}}async function St(e){try{await e.next()}catch(i){if(!(i instanceof X))throw i}if(e.headersSent)return;const t=e.status(),n=e.headers.get("Location");if(t>=301&&t<=308&&n){const i=Rt(n);if(i){e.headers.set("Location",i),e.getWritableStream().close();return}else e.status(200),e.headers.delete("Location")}}async function bt(e){if(await e.next(),e.headersSent||e.exited)return;const t=e.status(),n=e.headers.get("Location"),r=Y(e);e.request.headers.forEach((c,l)=>c),e.headers.set("Content-Type","application/json; charset=utf-8");const i={loaders:v(e),action:e.sharedMap.get(I),status:t!==200?t:200,href:Ae(e.url,r),redirect:n??void 0,isRewrite:e.sharedMap.get(Re)},a=e.getWritableStream().getWriter(),o=await e[D]._serializeData(i,!0);a.write(Q.encode(o)),e.sharedMap.set("qData",i),a.close()}function Rt(e){if(e.startsWith("/")){if(!e.includes(k)){const t=new URL(e,"http://localhost");return(t.pathname.endsWith("/")?t.pathname.slice(0,-1):t.pathname)+k+t.search}return e}else return}function fe(){return typeof performance<"u"?performance.now():0}async function U(e,t,n){const r=fe();try{return await n()}finally{const i=fe()-r;let a=e.sharedMap.get("@serverTiming");a||e.sharedMap.set("@serverTiming",a=[]),a.push([t,i])}}function At(e,...t){var n;const r=((n=e.get("content-type"))==null?void 0:n.split(/;/,1)[0].trim())??"";return t.includes(r)}async function Tt(e,t,n){const{render:r,qwikCityPlan:i,checkOrigin:a}=t,{pathname:s,isInternal:o}=J(e.url.pathname,i.trailingSlash),c=await ue(i,s,e.request.method,a??!0,r,o);if(c){const[l,f]=c;return nt(e,l,f,async d=>{const{pathname:p}=J(d.pathname,i.trailingSlash),g=await ue(i,p,e.request.method,a??!0,r,o);if(g){const[S,w]=g;return{loadedRoute:S,requestHandlers:w}}else return{loadedRoute:null,requestHandlers:[]}},i.trailingSlash,i.basePathname,n)}return null}async function ue(e,t,n,r,i,a){const{routes:s,serverPlugins:o,menus:c,cacheModules:l}=e,f=await qe(s,c,l,t,a),h=lt(o,f,n,r,yt(i),a);return h.length>0?[f,h]:null}var xt=class{#e=null;#t=new TextEncoder;#n=new TransformStream({transform:(e,t)=>{e=String(e);let n="";for(let r=0;r<e.length;r++){const i=e[r],a=i.charCodeAt(0);if(this.#e!==null){const s=this.#e;if(this.#e=null,56320<=a&&a<=57343){n+=s+i;continue}n+="�"}if(55296<=a&&a<=56319){this.#e=i;continue}if(56320<=a&&a<=57343){n+="�";continue}n+=i}n&&t.enqueue(this.#t.encode(n))},flush:e=>{this.#e!==null&&e.enqueue(new Uint8Array([239,191,189]))}});get encoding(){return this.#t.encoding}get readable(){return this.#n.readable}get writable(){return this.#n.writable}get[Symbol.toStringTag](){return"TextEncoderStream"}};function _t(e){try{new globalThis.TextEncoderStream}catch{globalThis.TextEncoderStream=xt}const t={_deserializeData:$e,_serializeData:Pe,_verifySerializable:De};e.manifest&&Oe(e.manifest);async function n(r,i,a){try{const s=new URL(r.url);if(Z(r.method,s))return i.ASSETS.fetch(r);const o=s.hostname!=="127.0.0.1"&&s.hostname!=="localhost"&&s.port===""&&r.method==="GET",c=new Request(s.href,r),l=o?await caches.open("custom:qwikcity"):null;if(l){const p=await l.match(c);if(p)return p}const h=await Tt({mode:"server",locale:void 0,url:s,request:r,env:{get(p){return i[p]}},getWritableStream:(p,g,S,w)=>{const{readable:b,writable:T}=new TransformStream,P=new Response(b,{status:p,headers:Je(g,S)});return w(P),T},getClientConn:()=>({ip:r.headers.get("CF-connecting-ip")||"",country:r.headers.get("CF-IPCountry")||""}),platform:{request:r,env:i,ctx:a}},e,t);if(h){h.completion.then(g=>{g&&console.error(g)});const p=await h.response;if(p)return p.ok&&l&&p.headers.has("Cache-Control")&&a.waitUntil(l.put(c,p.clone())),p}const d=Z(r.method||"GET",s)?"Not Found":ke(s.pathname);return new Response(d,{status:404,headers:{"Content-Type":"text/html; charset=utf-8","X-Not-Found":s.pathname}})}catch(s){return console.error(s),new Response(String(s||"Error"),{status:500,headers:{"Content-Type":"text/plain; charset=utf-8","X-Error":"cloudflare-pages"}})}}return n}const $t=_t({render:We,qwikCityPlan:Le,manifest:Ne});export{$t as onRequest};
